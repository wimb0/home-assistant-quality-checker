# saj_modbus: has-entity-name

| Info   | Value                                                                    |
|--------|--------------------------------------------------------------------------|
| Name   | [saj_modbus](https://www.home-assistant.io/integrations/saj_modbus/) |
| Rule   | [has-entity-name](https://developers.home-assistant.io/docs/core/integration-quality-scale/rules/has-entity-name)                                                     |
| Status | **todo**                                                                 |

## Overview

The `has-entity-name` rule applies to this integration as it creates sensor and number entities that are associated with a device. The purpose of this rule is to standardize how entity names are generated by combining the device name with the entity's specific name, leading to a more consistent user experience.

The `saj_modbus` integration currently does not follow this rule. The entity classes in `sensor.py` and `number.py` are missing the required `_attr_has_entity_name = True` attribute.

Specifically, in `sensor.py`, the `SajSensor` class uses an outdated pattern to manually construct the full entity name:

`sensor.py`:
```python
    @property
    def name(self):
        """Return the name."""
        return f"{self._platform_name} {self.entity_description.name}"
```

This manual concatenation of the device name (`_platform_name`) and the entity description name is what the `has-entity-name` pattern is designed to replace.

In `number.py`, the `SajNumber` class also lacks the `_attr_has_entity_name = True` attribute. While it doesn't manually build the name, it is still not compliant with the current best practice. To comply, all entities associated with a device must opt-in to the new naming scheme.

## Suggestions

To make the `saj_modbus` integration compliant, you should update the base entity classes in `sensor.py` and `number.py` to adopt the `has_entity_name` pattern. This involves adding a class attribute and removing the old manual name construction logic.

### 1. Update `sensor.py`

In `homeassistant/components/saj_modbus/sensor.py`, modify the `SajSensor` class:
1.  Add `_attr_has_entity_name = True` to the class.
2.  Remove the `name` property. Home Assistant will automatically use `self.entity_description.name` for the entity-specific part of the name.

```python
# homeassistant/components/saj_modbus/sensor.py

class SajSensor(CoordinatorEntity, SensorEntity):
    """Representation of an SAJ Modbus sensor."""

    _attr_has_entity_name = True

    def __init__(
        self,
        platform_name: str,
        hub: SAJModbusHub,
        device_info,
        description: SajModbusSensorEntityDescription,
    ):
        """Initialize the sensor."""
        self._platform_name = platform_name
        self._attr_device_info = device_info
        self.entity_description: SajModbusSensorEntityDescription = description

        super().__init__(coordinator=hub)

    # This property should be removed.
    # @property
    # def name(self):
    #     """Return the name."""
    #     return f"{self._platform_name} {self.entity_description.name}"

    @property
    def unique_id(self) -> str | None:
        """Return unique ID fro sensor."""
        return f"{self._platform_name}_{self.entity_description.key}"

# ... rest of the file
```

### 2. Update `number.py`

In `homeassistant/components/saj_modbus/number.py`, modify the `SajNumber` class:
1.  Simply add `_attr_has_entity_name = True` to the class definition. No other changes are needed as this class already correctly uses `entity_description` for its name.

```python
# homeassistant/components/saj_modbus/number.py

class SajNumber(CoordinatorEntity, NumberEntity):
    """Representation of an SAJ Modbus number."""

    _attr_has_entity_name = True
    coordinator: SAJModbusHub

    def __init__(
        self,
        platform_name: str,
        hub: SAJModbusHub,
        device_info,
        description: SajModbusNumberEntityDescription,
    ):
        """Initialize the sensor."""
        self._platform_name = platform_name
        self._attr_device_info = device_info
        self._attr_unique_id = f"{platform_name}_{description.key}"
        self.entity_description: SajModbusNumberEntityDescription = description

        super().__init__(coordinator=hub)
    
    # ... rest of the class
```

By making these changes, you delegate the responsibility of name generation to Home Assistant's core, which ensures that entity names like "SAJ Inverter Power generation on current day" are created correctly and consistently.

---

_Created at 2025-06-11 21:33:36. Prompt tokens: 16758, Output tokens: 1163, Total tokens: 21971._

_AI can be wrong. Always verify the report and the code against the rule._
